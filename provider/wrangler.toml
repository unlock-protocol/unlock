name = "rpc-provider"
main = "src/index.ts"
compatibility_date = "2022-08-17"
tail_consumers = [{service = "rpc-provider-tail"}]

# Optional environment variables
[vars]
# Cache duration in seconds for ENS/Basename resolution (default: 3600 seconds / 1 hour)
CACHE_DURATION_SECONDS = "3600"
# Locksmith IP addresses (comma-separated list)
LOCKSMITH_IPS = ""

# KV Namespaces
[[kv_namespaces]]
binding = "LOCK_CACHE"
id = "your-lock-cache-id"  # Replace with your actual KV namespace ID after creating it

# Rate limiting using Cloudflare's Rate Limiting API
# The rate limiting API is in open beta
[[unsafe.bindings]]
name = "STANDARD_RATE_LIMITER"
type = "ratelimit"
namespace_id = "1001"
# 10 requests per 10 seconds (similar to previous per-second limit)
simple = { limit = 10, period = 10 }

[[unsafe.bindings]]
name = "HOURLY_RATE_LIMITER"
type = "ratelimit"
namespace_id = "1002"
# 1000 requests per 60 minutes (similar to previous hourly limit)
simple = { limit = 1000, period = 60 }

# Development-specific configuration
[dev]
# Enable local KV for development
port = 8787

# Local KV for development
[[kv_namespaces]]
binding = "LOCK_CACHE" 
id = "dev-lock-cache"
preview_id = "dev-lock-cache"
