!function(e){var t={};function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";var o,s="object"==typeof Reflect?Reflect:null,r=s&&"function"==typeof s.apply?s.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};o=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function h(e,t,n,o){var s,r,i,a;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),i=r[t]),void 0===i)i=r[t]=n,++e._eventsCount;else if("function"==typeof i?i=r[t]=o?[n,i]:[i,n]:o?i.unshift(n):i.push(n),(s=u(e))>0&&i.length>s&&!i.warned){i.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=i.length,a=c,console&&console.warn&&console.warn(a)}return e}function d(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,r(this.listener,this.target,e))}function l(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=d.bind(o);return s.listener=n,o.wrapFn=s,s}function f(e,t,n){var o=e._events;if(void 0===o)return[];var s=o[t];return void 0===s?[]:"function"==typeof s?n?[s.listener||s]:[s]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(s):m(s,s.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var o="error"===e,s=this._events;if(void 0!==s)o=o&&void 0===s.error;else if(!o)return!1;if(o){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var u=c.length,h=m(c,u);for(n=0;n<u;++n)r(h[n],this,t)}return!0},a.prototype.addListener=function(e,t){return h(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return h(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,l(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,l(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,o,s,r,i;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(o=this._events))return this;if(void 0===(n=o[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){i=n[r].listener,s=r;break}if(s<0)return this;0===s?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,s),1===n.length&&(o[e]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",e,i||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,r=Object.keys(n);for(o=0;o<r.length;++o)"removeListener"!==(s=r[o])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?o(this._events):[]}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var o=n(2);function s(t,n,s,r,i){const a=e.env.DEBUG;if(!s||!n)throw new Error("cannot safely postMessage without knowing the target origin");const c={};return t.addEventListener(o.a.MESSAGE,e=>{if(e.source!==n||e.origin!==s)return;if(!e.data||!e.data.type)return;if(!e.data.hasOwnProperty("payload"))return;if("string"!=typeof e.data.type)return;const t=c[e.data.type];t&&t.size&&t.forEach(t=>{a&&console.log(`[pO] ${r} <-- ${i}`,e.data.type,e.data.payload,s);t(e.data.payload,(e,t)=>{a&&console.log(`[pO respond] ${r} --\x3e ${i}`,e,t,s),n.postMessage({type:e,payload:t},s)})})}),{addHandler:(e,t)=>{c[e]||(c[e]=new Map),c[e].set(t,t)},postMessage:(e,t)=>{a&&console.log(`[pO] ${r} --\x3e ${i}`,e,t,s),n.postMessage({type:e,payload:t},s)}}}function r(t,n,o){const s=[];return t.source!==n&&s.push("PostMessage source does not match expected source"),t.origin!==o&&s.push("PostMessage origin does not match expected origin"),t.data||s.push("PostMessage does not contain a data property"),t.data.type||s.push("PostMessage's data property does not have a type property"),t.data.hasOwnProperty("payload")||s.push("PostMessage's data property does not have a payload property"),"string"!=typeof t.data.type&&s.push("PostMessage's data.type property is not a string"),!s.length||(function(t,...n){e.env.DEBUG&&console[t](...n)}("error",s,t),!1)}function i(e,t,n,s){return n.addEventListener(o.a.MESSAGE,n=>{r(n,e,t)&&s(n.data.type,n.data.payload)}),{postMessage:(n,o)=>{const s=t;e.postMessage({type:n,payload:o},s)}}}function a(e,t,n,o="main window",r="iframe"){return s(e,t.contentWindow,n,o,r)}}).call(this,n(3))},function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e.STORAGE="storage",e.MESSAGE="message",e.UNLOCK="unlockProtocol"}(o||(o={}))},function(e,t){var n,o,s=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{o="function"==typeof clearTimeout?clearTimeout:i}catch(e){o=i}}();var c,u=[],h=!1,d=-1;function l(){h&&c&&(h=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!h){var e=a(l);h=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,h=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===i||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||h||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,n){var o=n(5),s=n(6);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var r={insert:"head",singleton:!1},i=(o(s,r),s.locals?s.locals:{});e.exports=i},function(e,t,n){"use strict";var o,s=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function a(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},o=[],s=0;s<e.length;s++){var r=e[s],c=t.base?r[0]+t.base:r[0],u=n[c]||0,h="".concat(c," ").concat(u);n[c]=u+1;var d=a(h),l={css:r[1],media:r[2],sourceMap:r[3]};-1!==d?(i[d].references++,i[d].updater(l)):i.push({identifier:h,updater:g(l,t),references:1}),o.push(h)}return o}function u(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var s=n.nc;s&&(o.nonce=s)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var i=r(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var h,d=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join("\n")});function l(e,t,n,o){var s=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=d(t,s);else{var r=document.createTextNode(s),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(r,i[t]):e.appendChild(r)}}function f(e,t,n){var o=n.css,s=n.media,r=n.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),r&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var p=null,m=0;function g(e,t){var n,o,s;if(t.singleton){var r=m++;n=p||(p=u(t)),o=l.bind(null,n,r,!1),s=l.bind(null,n,r,!0)}else n=u(t),o=f.bind(null,n,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=s());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var s=a(n[o]);i[s].references--}for(var r=c(e,t),u=0;u<n.length;u++){var h=a(n[u]);0===i[h].references&&(i[h].updater(),i.splice(h,1))}n=r}}}},function(e,t,n){(t=n(7)(!1)).push([e.i,".unlock.start {\n  display: none;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  border: 0;\n  z-index: -2147483647;\n}\n.unlock.show {\n  display: block;\n  z-index: 2147483647;\n}\n.unlock.hide {\n  right: 0;\n  top: initial;\n  left: initial;\n  bottom: 105px;\n  width: 134px;\n  height: 160px;\n  margin-right: -104px;\n  overflow: hidden;\n  transition: margin-right 0.4s ease-in;\n  animation: 2400ms slideout;\n}\n.unlock.optimism {\n  margin-right: 0;\n  animation: none;\n  transition: none;\n}\n.unlock.hide:hover {\n  margin-right: 0px;\n  width: 256px;\n}\n@keyframes slideout {\n  0% {\n    margin-right: 0px;\n  }\n  80% {\n    margin-right: 0px;\n  }\n  100% {\n    margin-right: -104px;\n  }\n}\n@media only screen and (max-width: 763px) {\n  .unlock.hide {\n    margin-right: 0;\n    display: flex;\n    bottom: 0;\n    width: 100vw;\n    height: 60px;\n    animation: none;\n    transition: none;\n    margin-right: 0;\n  }\n  .unlock.hide:hover {\n    margin-right: 0;\n    width: 100vw;\n  }\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var s=(i=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),r=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[n].concat(r).concat([s]).join("\n")}var i,a,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(o)for(var r=0;r<this.length;r++){var i=this[r][0];null!=i&&(s[i]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);o&&s[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t,n){"use strict";n.r(t);var o,s=n(0);!function(e){e.LOCKED="locked",e.UNLOCKED="unlocked",e.REDIRECT="redirect",e.GET_OPTIMISTIC="optimistic",e.GET_PESSIMISTIC="pessimistic",e.READY="ready",e.CONFIG="config",e.ACCOUNT="account",e.WEB3="web3",e.WEB3_RESULT="web3",e.READY_WEB3="ready/web3",e.WALLET_INFO="walletInfo",e.USING_MANAGED_ACCOUNT="info/managedUserAccount",e.UPDATE_LOCKS="update/locks",e.UPDATE_ACCOUNT="update/account",e.UPDATE_ACCOUNT_BALANCE="update/accountBalance",e.UPDATE_NETWORK="update/network",e.UPDATE_WALLET="update/walletModal",e.UPDATE_KEYS="update/keys",e.UPDATE_TRANSACTIONS="update/transactions",e.ERROR="error",e.SEND_UPDATES="send/updates",e.PURCHASE_KEY="purchaseKey",e.DISMISS_CHECKOUT="dismiss/checkout",e.INITIATED_TRANSACTION="initiated/transaction",e.SHOW_ACCOUNTS_MODAL="show/accountsModal",e.HIDE_ACCOUNTS_MODAL="hide/accountsModal",e.SET_USER_METADATA="setMetadata/user",e.SET_USER_METADATA_SUCCESS="setMetadata/user/success"}(o||(o={}));var r=n(1);function i(e,t,n){const o=e.document.createElement("iframe");return o.className="unlock start",o.setAttribute("src",t),o.setAttribute("name",n),o}function a(e,t){e.document.querySelector(`iframe[src="${t.src}"]`)||(e.document.body.insertAdjacentElement("afterbegin",t),e.setInterval(()=>{a(e,t)},500))}function c(e,t){e.document.body.style.overflow="hidden",t.className="unlock start show"}function u(e,t){t.className="unlock start",e.document.body.style.overflow=""}class h extends s.EventEmitter{}class d extends h{constructor(e,t){super(),this.emitWrapper=(e,t)=>{e===o.UPDATE_LOCKS&&t&&!Object.keys(t).length||(e!==o.WEB3||this.validateWeb3MethodCall(t))&&this.emit(e,t)},this.iframe=i(e,t,"unlock data");const n=new URL(this.iframe.src);a(e,this.iframe);const{postMessage:s}=Object(r.a)(this.iframe.contentWindow,n.origin,e,this.emitWrapper);this.postMessage=s}validateWeb3MethodCall(e){return!(!e||"object"!=typeof e)&&(!(!e.method||"string"!=typeof e.method)&&(!(!e.params||!Array.isArray(e.params))&&("number"==typeof e.id&&Math.round(e.id)===e.id)))}}class l extends s.EventEmitter{}class f extends l{constructor(e,t){super(),this.setReady=()=>{this.isReady=!0,this.flushBuffer()},this.isReady=!1,this.window=e,this.iframe=i(e,t,"unlock checkout");const n=new URL(this.iframe.src);a(e,this.iframe),this.buffer=[];const{postMessage:o}=Object(r.a)(this.iframe.contentWindow,n.origin,e,this.emit.bind(this));this.postMessage=(e,t)=>{this.isReady?o(e,t):this.buffer.push([e,t])}}flushBuffer(){this.isReady&&this.buffer.forEach(([e,t])=>{this.postMessage(e,t)})}showIframe(){c(this.window,this.iframe)}hideIframe(){u(this.window,this.iframe)}}class p extends s.EventEmitter{}class m extends p{constructor(e,t){super(),this.buffer=[],this.ready=!1,this.window=e,this.iframe={contentWindow:{postMessage:()=>{}},className:"",name:"unlock accounts",src:t,setAttribute:()=>{}}}createIframe(){const e=new URL(this.iframe.src);this.iframe=i(this.window,this.iframe.src,"unlock accounts"),a(this.window,this.iframe);const{postMessage:t,addHandler:n}=Object(r.b)(this.window,this.iframe,e.origin,"main window","User Accounts iframe");this._postMessage=t,this._addHandler=n,this.setupListeners()}showIframe(){c(this.window,this.iframe)}hideIframe(){u(this.window,this.iframe)}setupListeners(){this.addHandler(o.READY,()=>{this.ready=!0,this.sendBufferedMessages(),this.emit(o.READY)}),this.addHandler(o.UPDATE_ACCOUNT,e=>this.emit(o.UPDATE_ACCOUNT,e)),this.addHandler(o.UPDATE_NETWORK,e=>this.emit(o.UPDATE_NETWORK,e)),this.addHandler(o.INITIATED_TRANSACTION,()=>this.emit(o.INITIATED_TRANSACTION)),this.addHandler(o.SHOW_ACCOUNTS_MODAL,()=>this.emit(o.SHOW_ACCOUNTS_MODAL)),this.addHandler(o.HIDE_ACCOUNTS_MODAL,()=>this.emit(o.HIDE_ACCOUNTS_MODAL))}sendBufferedMessages(){this.buffer.forEach(({type:e,payload:t})=>{this.postMessage(e,t)}),this.buffer=[]}async addHandler(e,t){this._addHandler&&this._addHandler(e,t)}async postMessage(e,t){this.ready?this._postMessage&&this._postMessage(e,t):this.buffer.push({type:e,payload:t})}}new RegExp("^0x[a-fA-F0-9]{40}$"),new RegExp("^0x[a-fA-F0-9]{64}$"),new RegExp("(?:/([a-z0-9]+))?/(0x[a-fA-F0-9]{40})(?:/([^#?]+)/?)?");const g=["0x89d24a6b4ccb1b6faa2625fe562bdd9a23260359","0x6b175474e89094c44da98b954eedeac495271d0f","0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48","0xaFF4481D10270F50f203E0763e2597776068CBc5"].map(e=>e.toLowerCase());var A=e=>{const t={};return Object.keys(e).forEach(e=>{g.indexOf(e.toLowerCase())>-1?t[e]="35":t[e]="0"}),t};function E(e,t,n){n.postMessage(o.WEB3_RESULT,{id:e,jsonrpc:"2.0",result:{id:e,jsonrpc:"2.0",result:t}})}function v({iframes:e,hasWallet:t,setHasWeb3:n,getHasWeb3:s,isMetaMask:r,window:i}){e.checkout.on(o.PURCHASE_KEY,t=>{e.data.postMessage(o.PURCHASE_KEY,t)}),e.data.on(o.READY_WEB3,async()=>{if(!t)return n(!1),void e.data.postMessage(o.WALLET_INFO,{noWallet:!0,notEnabled:!1,isMetaMask:!1});n(!0);try{await async function(e,t){if(!e.web3||!e.web3.currentProvider)return;const n=e.web3.currentProvider;n.enable&&(t.checkout.postMessage(o.UPDATE_WALLET,!0),await n.enable(),t.checkout.postMessage(o.UPDATE_WALLET,!1))}(i,e)}catch(t){return void e.data.postMessage(o.WALLET_INFO,{noWallet:!1,notEnabled:!0,isMetaMask:r})}e.data.postMessage(o.WALLET_INFO,{noWallet:!1,notEnabled:!1,isMetaMask:r})}),e.data.on(o.WEB3,t=>{if(!s())return void e.data.postMessage(o.WEB3_RESULT,{id:t.id,jsonrpc:"2.0",error:"No web3 wallet is available"});const{method:n,params:r,id:a}=t,c=i.web3.currentProvider;(c.sendAsync||c.send).call(c,{method:n,params:r,jsonrpc:"2.0",id:a},(t,n)=>{e.data.postMessage(o.WEB3_RESULT,t?{id:a,error:t,jsonrpc:"2.0"}:{id:a,result:n,jsonrpc:"2.0"})})})}class w{constructor(e,t,n,o){this.data=new d(e,t),this.checkout=new f(e,n),this.accounts=new m(e,o)}init(e){!function({config:e,dataIframe:t}){t.on(o.READY,()=>{t.postMessage(o.CONFIG,e)})}({config:e,dataIframe:this.data,checkoutIframe:this.checkout})}}class y{constructor(e,t,n,o){this.hasWeb3=!1,this.userAccountAddress=null,this.setUserAccountAddress=e=>{this.userAccountAddress=e},this.setUserAccountNetwork=e=>{this.userAccountNetwork=e},this.getUserAccountAddress=()=>this.userAccountAddress,this.getUserAccountNetwork=()=>this.userAccountNetwork,this.setHasWeb3=e=>{this.hasWeb3=e},this.getHasWeb3=()=>this.hasWeb3,this.window=e,this.iframes=t,this.config=n,this.userAccountNetwork=o.network}init({shouldUseUserAccounts:e,hasWallet:t,isMetaMask:n}){if(e&&function({iframes:e,config:t,setUserAccountAddress:n,setUserAccountNetwork:s}){e.accounts.on(o.READY,()=>{e.accounts.postMessage(o.CONFIG,t),e.data.postMessage(o.SEND_UPDATES,"locks")}),e.data.on(o.UPDATE_LOCKS,t=>{e.accounts.postMessage(o.UPDATE_LOCKS,t)}),e.accounts.on(o.UPDATE_ACCOUNT,e=>{n(e)}),e.accounts.on(o.UPDATE_NETWORK,e=>{s(e)}),e.accounts.on(o.INITIATED_TRANSACTION,()=>{e.data.postMessage(o.INITIATED_TRANSACTION,void 0)}),e.accounts.createIframe()}({iframes:this.iframes,config:this.config,setUserAccountAddress:this.setUserAccountAddress,setUserAccountNetwork:this.setUserAccountNetwork}),e&&!t){!function({iframes:e,setHasWeb3:t,getUserAccountAddress:n,getUserAccountNetwork:s}){e.accounts.on(o.READY,()=>{e.accounts.postMessage(o.SEND_UPDATES,"account"),e.accounts.postMessage(o.SEND_UPDATES,"network")}),e.checkout.on(o.PURCHASE_KEY,t=>{e.accounts.postMessage(o.PURCHASE_KEY,t)}),t(!0),e.data.on(o.READY_WEB3,async()=>{e.data.postMessage(o.WALLET_INFO,{noWallet:!1,notEnabled:!1,isMetaMask:!1})}),e.data.on(o.WEB3,t=>{const{method:r,id:i}=t,a=n(),c=s();switch(r){case"eth_accounts":E(i,a?[a]:[],e.data);break;case"net_version":E(i,c,e.data);break;default:e.data.postMessage(o.WEB3_RESULT,{id:i,jsonrpc:"2.0",error:`"${r}" is not supported`})}})}({iframes:this.iframes,setHasWeb3:this.setHasWeb3,getUserAccountAddress:this.getUserAccountAddress,getUserAccountNetwork:this.getUserAccountNetwork});const{checkout:e}=this.iframes;e.once(o.READY,()=>{e.postMessage(o.USING_MANAGED_ACCOUNT,void 0)})}else v({iframes:this.iframes,hasWallet:t,setHasWeb3:this.setHasWeb3,getHasWeb3:this.getHasWeb3,isMetaMask:n,window:this.window})}}function C(e){if(!e||!e.locks||"object"!=typeof e.locks)return e;const t=Object.keys(e.locks);return t.length?{...e,locks:t.reduce((t,n)=>({...t,[n.toLowerCase()]:e.locks[n]}),{})}:e}class T{constructor(e,t){this.showCheckoutWhenAccountsHides=!1,this.showingCheckout=!1,this.showingAccountsIframe=!1,this.lockStatus=void 0,this.blockchainData={locks:{},account:null,balance:{},network:1,keys:{},transactions:{}},this.toggleLockState=e=>{const t={[o.LOCKED]:!0,[o.UNLOCKED]:!1}[e];this.lockStatus!==e&&(this.dispatchEvent(e),this.setCachedLockedState(t),this.lockStatus=e,this.iframes.accounts.postMessage(e,void 0))},this.getCachedLockState=()=>{try{const e=this.window.localStorage.getItem("__unlockProtocol.locked");return e?"true"!==e&&"false"!==e?"ignore":JSON.parse(e):"ignore"}catch(e){return"ignore"}},this.dispatchCachedLockState=()=>{const e=this.getCachedLockState();!0===e&&this.dispatchEvent("locked"),!1===e&&this.dispatchEvent("unlocked")},this.setCachedLockedState=e=>{try{this.window.localStorage.setItem("__unlockProtocol.locked",JSON.stringify(e))}catch(e){}},this.setCachedAccountAddress=e=>{try{this.window.localStorage.setItem("__unlockProtocol.accountAddress",e)}catch(e){}},this.setupUnlockProtocolVariable=()=>{const e=()=>{this.showCheckoutIframe()},t={},n={writable:!1,configurable:!1,enumerable:!1};Object.defineProperties(t,{loadCheckoutModal:{value:e,...n},getState:{value:()=>this.lockStatus,...n},blockchainData:{value:()=>this.blockchainData,...n},resetConfig:{value:e=>{this.lockStatus=void 0;const t=C(e);this.iframes.accounts.postMessage(o.CONFIG,t),this.iframes.checkout.postMessage(o.CONFIG,t),this.iframes.data.postMessage(o.CONFIG,t)},...n}});const s=Object.freeze||Object;s(t.prototype),s(t);try{this.window.unlockProtocol&&this.window.unlockProtocol.loadCheckoutModal===e||Object.defineProperties(this.window,{unlockProtocol:{value:t,...n}})}catch(e){console.error("WARNING: unlockProtocol already defined, cannot re-define it")}},this.dispatchEvent=e=>{let t;try{t=new this.window.CustomEvent("unlockProtocol",{detail:e})}catch(n){t=this.window.document.createEvent("customevent"),t.initCustomEvent("unlockProtocol",!0,!0,e)}this.window.dispatchEvent(t)},this.hideCheckoutIframe=()=>{this.showCheckoutWhenAccountsHides=!1,this.showingCheckout=!1,this.iframes.checkout.hideIframe()},this.showCheckoutIframe=()=>{this.showingAccountsIframe?(this.showCheckoutWhenAccountsHides=!0,this.showingCheckout=!1):(this.showingCheckout=!0,this.showCheckoutWhenAccountsHides=!1,this.iframes.checkout.showIframe())},this.showAccountIframe=()=>{this.showingCheckout&&(this.showCheckoutWhenAccountsHides=!0,this.showingCheckout=!1,this.iframes.checkout.hideIframe()),this.showingAccountsIframe=!0,this.iframes.accounts.showIframe()},this.hideAccountIframe=()=>{this.showingAccountsIframe=!1,this.iframes.accounts.hideIframe(),this.showCheckoutWhenAccountsHides&&(this.showingCheckout=!0,this.showCheckoutWhenAccountsHides=!1,this.iframes.checkout.showIframe())},this.window=e,this.iframes=t,this.setupUnlockProtocolVariable(),this.dispatchCachedLockState()}init(){!function({iframes:e,toggleLockState:t,hideAccountIframe:n,showAccountIframe:s,hideCheckoutIframe:r,blockchainData:i,setCachedAccountAddress:a}){e.data.on(o.LOCKED,()=>{t(o.LOCKED)}),e.data.on(o.UNLOCKED,()=>{t(o.UNLOCKED)}),e.data.on(o.ERROR,e=>{"no ethereum wallet is available"===e&&t(o.LOCKED)}),e.data.on(o.UPDATE_LOCKS,e=>{i.locks=e}),e.data.on(o.UPDATE_ACCOUNT,e=>{i.account=e,e&&a(e)}),e.data.on(o.UPDATE_ACCOUNT_BALANCE,e=>{i.balance=e}),e.data.on(o.UPDATE_NETWORK,e=>{i.network=e}),e.data.on(o.UPDATE_KEYS,e=>{i.keys=e}),e.data.on(o.UPDATE_TRANSACTIONS,e=>{i.transactions=e}),e.checkout.on(o.DISMISS_CHECKOUT,()=>{r()}),e.accounts.on(o.SHOW_ACCOUNTS_MODAL,()=>{s()}),e.accounts.on(o.HIDE_ACCOUNTS_MODAL,()=>{n()})}({iframes:this.iframes,toggleLockState:this.toggleLockState,hideAccountIframe:this.hideAccountIframe,showAccountIframe:this.showAccountIframe,hideCheckoutIframe:this.hideCheckoutIframe,blockchainData:this.blockchainData,setCachedAccountAddress:this.setCachedAccountAddress})}}function b(e){return!(!e.web3||!e.web3.currentProvider)}function k(e){return!!b(e)&&!!e.web3.currentProvider.isMetaMask}function _(e,t){return!b(e)&&("true"===t.unlockUserAccounts||!0===t.unlockUserAccounts)}function U(e,t){let n;try{n=new t.CustomEvent("unlockProtocol",{detail:e})}catch(o){n=t.document.createEvent("customevent"),n.initCustomEvent("unlockProtocol",!0,!0,e)}t.dispatchEvent(n)}function O(e,t,n,s=!1){let r=C(n);if(!r)throw new Error("Invalid configuration, please set window.unlockProtocolConfig");const i=!!r.unlockUserAccounts;!!e.web3||i||(r={...r,locks:{}},U("locked",e));const a=`?origin=${encodeURIComponent(e.origin)}`,c=`${t.paywallUrl}/static/data-iframe.1.0.html${a}`,u=`${t.paywallUrl}/checkout${a}`,h=t.accountsUrl+a,d=new w(e,c,u,h);d.init(r);const l=new y(e,d,r,t),f=new T(e,d);if(f.init(),s){const e=t=>{t&&(f.showCheckoutIframe(),d.data.removeListener(o.UPDATE_ACCOUNT,e))};d.data.on(o.UPDATE_ACCOUNT,e)}const p=function(e,t){return{hasWallet:b(e),isMetaMask:k(e),shouldUseUserAccounts:_(e,t)}}(e,r);return l.init(p),function({usingManagedAccount:e,dataIframe:t,checkoutIframe:n,config:s}){t.on(o.UPDATE_ACCOUNT,e=>n.postMessage(o.UPDATE_ACCOUNT,e)),t.on(o.UPDATE_ACCOUNT_BALANCE,t=>{let s=t;e&&(s=A(t)),n.postMessage(o.UPDATE_ACCOUNT_BALANCE,s)}),t.on(o.UPDATE_LOCKS,e=>n.postMessage(o.UPDATE_LOCKS,e)),t.on(o.UPDATE_KEYS,e=>n.postMessage(o.UPDATE_KEYS,e)),t.on(o.UPDATE_TRANSACTIONS,e=>n.postMessage(o.UPDATE_TRANSACTIONS,e)),t.on(o.UPDATE_NETWORK,e=>n.postMessage(o.UPDATE_NETWORK,e)),n.on(o.READY,()=>{n.setReady(),n.postMessage(o.CONFIG,s);["locks","account","balance","network","keys","transactions"].forEach(e=>t.postMessage(o.SEND_UPDATES,e))}),n.on(o.SET_USER_METADATA,e=>{t.postMessage(o.SET_USER_METADATA,e)}),t.on(o.SET_USER_METADATA_SUCCESS,()=>{n.postMessage(o.SET_USER_METADATA_SUCCESS,void 0)}),t.on(o.ERROR,e=>n.postMessage(o.ERROR,e)),t.on(o.LOCKED,()=>n.postMessage(o.LOCKED,void 0)),t.on(o.UNLOCKED,e=>n.postMessage(o.UNLOCKED,e))}({usingManagedAccount:p.shouldUseUserAccounts,constants:t,config:r,dataIframe:d.data,checkoutIframe:d.checkout}),d}n(4);!function(e,t){if(!!e.web3)try{if(!e.localStorage.getItem("__unlockProtocol.accountAddress"))return e.unlockProtocol={loadCheckoutModal:()=>{O(e,t,e.unlockProtocolConfig,!0)},resetConfig:n=>{O(e,t,n,!1)}},void U("locked",e)}catch(e){}let n=!1;if("loading"!==document.readyState)O(e,t,e.unlockProtocolConfig),n=!0;else{const o=()=>{n||O(e,t,e.unlockProtocolConfig),n=!0};e.addEventListener("DOMContentLoaded",o),e.addEventListener("load",o)}}(window,{unlockEnv:"prod",unlockAppUrl:"https://app.unlock-protocol.com",accountsUrl:"https://app.unlock-protocol.com/account",paywallUrl:"https://paywall.unlock-protocol.com",usersIframeUrl:"https://app.unlock-protocol.com/account",readOnlyProvider:"https://eth-mainnet.alchemyapi.io/jsonrpc/b7Mxclz5hGyHqoeodGLQ17F5Qi97S7xJ",locksmithUri:"https://locksmith.unlock-protocol.com",erc20ContractSymbol:"DAI",erc20ContractAddress:"0x89d24a6b4ccb1b6faa2625fe562bdd9a23260359",httpProvider:"ganache-integration"})}]);
//# sourceMappingURL=unlock.1.0.min.js.map