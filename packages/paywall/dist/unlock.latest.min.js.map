{"version":3,"sources":["webpack://@unlock-protocol/paywall/webpack/universalModuleDefinition","webpack://@unlock-protocol/paywall/./src/iframe.css","webpack://@unlock-protocol/paywall/../node_modules/css-loader/dist/runtime/api.js","webpack://@unlock-protocol/paywall/../node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://@unlock-protocol/paywall/../node_modules/postmate/build/postmate.es.js","webpack://@unlock-protocol/paywall/./src/iframe.css?976e","webpack://@unlock-protocol/paywall/../node_modules/style-loader/dist/runtime/getTarget.js","webpack://@unlock-protocol/paywall/../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://@unlock-protocol/paywall/../node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://@unlock-protocol/paywall/../node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://@unlock-protocol/paywall/../networks/dist/index.js","webpack://@unlock-protocol/paywall/../networks/dist/networks/index.js","webpack://@unlock-protocol/paywall/../networks/dist/networks/localhost.js","webpack://@unlock-protocol/paywall/../networks/dist/networks/mainnet.js","webpack://@unlock-protocol/paywall/../networks/dist/networks/polygon.js","webpack://@unlock-protocol/paywall/../networks/dist/networks/rinkeby.js","webpack://@unlock-protocol/paywall/../networks/dist/networks/xdai.js","webpack://@unlock-protocol/paywall/./src/Paywall.ts","webpack://@unlock-protocol/paywall/./src/networkConfigs.ts","webpack://@unlock-protocol/paywall/./src/utils/enableInjectedProvider.ts","webpack://@unlock-protocol/paywall/./src/utils/getTransaction.ts","webpack://@unlock-protocol/paywall/./src/utils/index.ts","webpack://@unlock-protocol/paywall/./src/utils/isUnlocked.ts","webpack://@unlock-protocol/paywall/./src/utils/keyExpirationTimestampFor.ts","webpack://@unlock-protocol/paywall/./src/utils/localStorage.ts","webpack://@unlock-protocol/paywall/./src/utils/optimisticUnlocking.ts","webpack://@unlock-protocol/paywall/webpack/bootstrap","webpack://@unlock-protocol/paywall/webpack/runtime/compat get default export","webpack://@unlock-protocol/paywall/webpack/runtime/define property getters","webpack://@unlock-protocol/paywall/webpack/runtime/hasOwnProperty shorthand","webpack://@unlock-protocol/paywall/webpack/runtime/make namespace object","webpack://@unlock-protocol/paywall/./src/index.ts"],"names":["root","factory","exports","module","define","amd","this","___CSS_LOADER_EXPORT___","push","id","cssWithMappingToString","list","toString","map","item","content","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","_i","_i2","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","messageType","_messageId","messageTypes","handshake","call","emit","reply","request","sanitize","message","allowedOrigin","origin","type","postmate","ParentAPI","info","_this","parent","frame","child","childOrigin","events","listener","e","_ref","value","name","addEventListener","_proto","prototype","get","property","_this2","Postmate","Promise","resolve","uid","transact","removeEventListener","postMessage","on","eventName","callback","destroy","window","parentNode","removeChild","ChildAPI","_this3","model","parentOrigin","_e$data","unwrappedContext","resolveValue","then","_ref2","_ref2$container","container","document","body","url","_ref2$classListArray","classListArray","createElement","classList","add","apply","appendChild","contentWindow","contentDocument","parentWindow","sendHandshake","responseInterval","_this4","a","href","protocol","location","host","port","hostname","resolveOrigin","attempt","reject","clearInterval","doSend","loaded","setInterval","attachEvent","onload","src","debug","Model","sendHandshakeReply","_this5","shake","defaults","Object","keys","forEach","key","options","css","style","styleSheet","cssText","firstChild","createTextNode","nonce","setAttribute","target","Error","domAPI","insertStyleElement","memo","styleTarget","querySelector","HTMLIFrameElement","head","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","idCountMap","identifiers","base","count","index","obj","sourceMap","references","updater","addStyle","api","update","newObj","remove","lastIdentifiers","newList","newLastIdentifiers","_index","splice","setAttributes","attributes","insert","removeAttribute","styleTagTransform","removeStyleElement","defineProperty","networks","localhost","polygon","xdai","rinkeby","mainnet","networks_1","networks_2","enumerable","default","__createBinding","create","o","m","k","k2","__exportStar","p","hasOwnProperty","provider","locksmithUri","unlockAppUrl","subgraphURI","readOnlyProvider","unlockAddress","blockTime","explorer","urls","address","transaction","hash","erc20","symbol","requiredConfirmations","baseCurrencySymbol","nativeCurrency","decimals","__importDefault","mod","__esModule","Paywall","CheckoutEvents","checkoutIframeClassName","postmate_1","utils_1","localStorage_1","isUnlocked_1","optimisticUnlocking_1","enableInjectedProvider_1","constructor","paywallConfig","networkConfigs","childCallBuffer","loadCheckoutModal","config","iframe","showIframe","shakeHands","sendOrBuffer","getUserAccountAddress","userAccountAddress","resetConfig","injectProviderInfo","checkKeysAndLock","getState","lockStatus","cacheUserInfo","async","store","loadCache","retrieve","lockPage","unlockedLocks","isUnlocked","unlockPage","network","getElementsByClassName","closeModal","hideIframe","userInfo","handleUserInfoEvent","methodCall","handleMethodCallEvent","onEvent","handleOnEventEvent","transactionInfo","handleTransactionInfoEvent","bufferedCall","method","args","lock","dispatchEvent","unlockEvents","transactionSent","pessimistic","willUnlock","authenticated","params","enableInjectedProvider","sendAsync","error","response","status","state","locks","getProvider","baseUrl","match","chainId","ethereum","web3","currentProvider","enable","getTransaction","transactionHash","rpcRequest","jsonrpc","fetch","headers","json","setupUnlockProtocolVariable","event","CustomEvent","detail","createEvent","initCustomEvent","properties","unlockProtocol","immutable","writable","configurable","immutableProperties","assign","defineProperties","freeze","console","warn","newConfig","useDelegatedProvider","keyExpirationTimestampFor_1","all","entries","lockAddress","keyExpirationTimestampFor","Date","getTime","optimisticUnlocking","userAddress","to","substring","parseInt","Number","MAX_SAFE_INTEGER","localStorageAvailable","storage","localStorage","x","setItem","removeItem","DOMException","code","getItem","parse","withinLast24Hours","getTransactionsForUserAndLocks","optimisticLocks","getTransaction_1","user","recentTransactions","filter","tx","createdAt","recipient","reduce","accumulator","currentValue","unlocked","optimisticIfMissing","blockNumber","transactions","dateString","yesterday","now","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","definition","prop","r","Symbol","toStringTag","Paywall_1","networkConfigs_1","rawConfig","unlockProtocolConfig","paywall"],"mappings":"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","file":"unlock.latest.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"@unlock-protocol/paywall\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@unlock-protocol/paywall\"] = factory();\n\telse\n\t\troot[\"@unlock-protocol/paywall\"] = factory();\n})(this, function() {\nreturn ","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".unlock-protocol-checkout {\\n  display: none;\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100vh;\\n  border: 0;\\n  z-index: -2147483647;\\n}\\n\\n.unlock-protocol-checkout.show {\\n  display: block;\\n  z-index: 2147483647;\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/iframe.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,aAAa;EACb,eAAe;EACf,MAAM;EACN,OAAO;EACP,WAAW;EACX,aAAa;EACb,SAAS;EACT,oBAAoB;AACtB;;AAEA;EACE,cAAc;EACd,mBAAmB;AACrB\",\"sourcesContent\":[\".unlock-protocol-checkout {\\n  display: none;\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100vh;\\n  border: 0;\\n  z-index: -2147483647;\\n}\\n\\n.unlock-protocol-checkout.show {\\n  display: block;\\n  z-index: 2147483647;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var _i = 0; _i < this.length; _i++) {\n        var id = this[_i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i2 = 0; _i2 < modules.length; _i2++) {\n      var item = [].concat(modules[_i2]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","/**\n  postmate - A powerful, simple, promise-based postMessage library\n  @version v1.5.2\n  @link https://github.com/dollarshaveclub/postmate\n  @author Jacob Kelley <jakie8@gmail.com>\n  @license MIT\n**/\n/**\n * The type of messages our frames our sending\n * @type {String}\n */\nvar messageType = 'application/x-postmate-v1+json';\n/**\n * The maximum number of attempts to send a handshake request to the parent\n * @type {Number}\n */\n\nvar maxHandshakeRequests = 5;\n/**\n * A unique message ID that is used to ensure responses are sent to the correct requests\n * @type {Number}\n */\n\nvar _messageId = 0;\n/**\n * Increments and returns a message ID\n * @return {Number} A unique ID for a message\n */\n\nvar generateNewMessageId = function generateNewMessageId() {\n  return ++_messageId;\n};\n/**\n * Postmate logging function that enables/disables via config\n * @param  {Object} ...args Rest Arguments\n */\n\nvar log = function log() {\n  var _console;\n\n  return Postmate.debug ? (_console = console).log.apply(_console, arguments) : null;\n}; // eslint-disable-line no-console\n\n/**\n * Takes a URL and returns the origin\n * @param  {String} url The full URL being requested\n * @return {String}     The URLs origin\n */\n\nvar resolveOrigin = function resolveOrigin(url) {\n  var a = document.createElement('a');\n  a.href = url;\n  var protocol = a.protocol.length > 4 ? a.protocol : window.location.protocol;\n  var host = a.host.length ? a.port === '80' || a.port === '443' ? a.hostname : a.host : window.location.host;\n  return a.origin || protocol + \"//\" + host;\n};\nvar messageTypes = {\n  handshake: 1,\n  'handshake-reply': 1,\n  call: 1,\n  emit: 1,\n  reply: 1,\n  request: 1\n  /**\n   * Ensures that a message is safe to interpret\n   * @param  {Object} message The postmate message being sent\n   * @param  {String|Boolean} allowedOrigin The whitelisted origin or false to skip origin check\n   * @return {Boolean}\n   */\n\n};\nvar sanitize = function sanitize(message, allowedOrigin) {\n  if (typeof allowedOrigin === 'string' && message.origin !== allowedOrigin) return false;\n  if (!message.data) return false;\n  if (typeof message.data === 'object' && !('postmate' in message.data)) return false;\n  if (message.data.type !== messageType) return false;\n  if (!messageTypes[message.data.postmate]) return false;\n  return true;\n};\n/**\n * Takes a model, and searches for a value by the property\n * @param  {Object} model     The dictionary to search against\n * @param  {String} property  A path within a dictionary (i.e. 'window.location.href')\n * @param  {Object} data      Additional information from the get request that is\n *                            passed to functions in the child model\n * @return {Promise}\n */\n\nvar resolveValue = function resolveValue(model, property) {\n  var unwrappedContext = typeof model[property] === 'function' ? model[property]() : model[property];\n  return Postmate.Promise.resolve(unwrappedContext);\n};\n/**\n * Composes an API to be used by the parent\n * @param {Object} info Information on the consumer\n */\n\nvar ParentAPI =\n/*#__PURE__*/\nfunction () {\n  function ParentAPI(info) {\n    var _this = this;\n\n    this.parent = info.parent;\n    this.frame = info.frame;\n    this.child = info.child;\n    this.childOrigin = info.childOrigin;\n    this.events = {};\n\n    if (process.env.NODE_ENV !== 'production') {\n      log('Parent: Registering API');\n      log('Parent: Awaiting messages...');\n    }\n\n    this.listener = function (e) {\n      if (!sanitize(e, _this.childOrigin)) return false;\n      /**\n       * the assignments below ensures that e, data, and value are all defined\n       */\n\n      var _ref = ((e || {}).data || {}).value || {},\n          data = _ref.data,\n          name = _ref.name;\n\n      if (e.data.postmate === 'emit') {\n        if (process.env.NODE_ENV !== 'production') {\n          log(\"Parent: Received event emission: \" + name);\n        }\n\n        if (name in _this.events) {\n          _this.events[name].call(_this, data);\n        }\n      }\n    };\n\n    this.parent.addEventListener('message', this.listener, false);\n\n    if (process.env.NODE_ENV !== 'production') {\n      log('Parent: Awaiting event emissions from Child');\n    }\n  }\n\n  var _proto = ParentAPI.prototype;\n\n  _proto.get = function get(property) {\n    var _this2 = this;\n\n    return new Postmate.Promise(function (resolve) {\n      // Extract data from response and kill listeners\n      var uid = generateNewMessageId();\n\n      var transact = function transact(e) {\n        if (e.data.uid === uid && e.data.postmate === 'reply') {\n          _this2.parent.removeEventListener('message', transact, false);\n\n          resolve(e.data.value);\n        }\n      }; // Prepare for response from Child...\n\n\n      _this2.parent.addEventListener('message', transact, false); // Then ask child for information\n\n\n      _this2.child.postMessage({\n        postmate: 'request',\n        type: messageType,\n        property: property,\n        uid: uid\n      }, _this2.childOrigin);\n    });\n  };\n\n  _proto.call = function call(property, data) {\n    // Send information to the child\n    this.child.postMessage({\n      postmate: 'call',\n      type: messageType,\n      property: property,\n      data: data\n    }, this.childOrigin);\n  };\n\n  _proto.on = function on(eventName, callback) {\n    this.events[eventName] = callback;\n  };\n\n  _proto.destroy = function destroy() {\n    if (process.env.NODE_ENV !== 'production') {\n      log('Parent: Destroying Postmate instance');\n    }\n\n    window.removeEventListener('message', this.listener, false);\n    this.frame.parentNode.removeChild(this.frame);\n  };\n\n  return ParentAPI;\n}();\n/**\n * Composes an API to be used by the child\n * @param {Object} info Information on the consumer\n */\n\nvar ChildAPI =\n/*#__PURE__*/\nfunction () {\n  function ChildAPI(info) {\n    var _this3 = this;\n\n    this.model = info.model;\n    this.parent = info.parent;\n    this.parentOrigin = info.parentOrigin;\n    this.child = info.child;\n\n    if (process.env.NODE_ENV !== 'production') {\n      log('Child: Registering API');\n      log('Child: Awaiting messages...');\n    }\n\n    this.child.addEventListener('message', function (e) {\n      if (!sanitize(e, _this3.parentOrigin)) return;\n\n      if (process.env.NODE_ENV !== 'production') {\n        log('Child: Received request', e.data);\n      }\n\n      var _e$data = e.data,\n          property = _e$data.property,\n          uid = _e$data.uid,\n          data = _e$data.data;\n\n      if (e.data.postmate === 'call') {\n        if (property in _this3.model && typeof _this3.model[property] === 'function') {\n          _this3.model[property](data);\n        }\n\n        return;\n      } // Reply to Parent\n\n\n      resolveValue(_this3.model, property).then(function (value) {\n        return e.source.postMessage({\n          property: property,\n          postmate: 'reply',\n          type: messageType,\n          uid: uid,\n          value: value\n        }, e.origin);\n      });\n    });\n  }\n\n  var _proto2 = ChildAPI.prototype;\n\n  _proto2.emit = function emit(name, data) {\n    if (process.env.NODE_ENV !== 'production') {\n      log(\"Child: Emitting Event \\\"\" + name + \"\\\"\", data);\n    }\n\n    this.parent.postMessage({\n      postmate: 'emit',\n      type: messageType,\n      value: {\n        name: name,\n        data: data\n      }\n    }, this.parentOrigin);\n  };\n\n  return ChildAPI;\n}();\n/**\n  * The entry point of the Parent.\n * @type {Class}\n */\n\nvar Postmate =\n/*#__PURE__*/\nfunction () {\n  // eslint-disable-line no-undef\n  // Internet Explorer craps itself\n\n  /**\n   * Sets options related to the Parent\n   * @param {Object} object The element to inject the frame into, and the url\n   * @return {Promise}\n   */\n  function Postmate(_ref2) {\n    var _ref2$container = _ref2.container,\n        container = _ref2$container === void 0 ? typeof container !== 'undefined' ? container : document.body : _ref2$container,\n        model = _ref2.model,\n        url = _ref2.url,\n        name = _ref2.name,\n        _ref2$classListArray = _ref2.classListArray,\n        classListArray = _ref2$classListArray === void 0 ? [] : _ref2$classListArray;\n    // eslint-disable-line no-undef\n    this.parent = window;\n    this.frame = document.createElement('iframe');\n    this.frame.name = name || '';\n    this.frame.classList.add.apply(this.frame.classList, classListArray);\n    container.appendChild(this.frame);\n    this.child = this.frame.contentWindow || this.frame.contentDocument.parentWindow;\n    this.model = model || {};\n    return this.sendHandshake(url);\n  }\n  /**\n   * Begins the handshake strategy\n   * @param  {String} url The URL to send a handshake request to\n   * @return {Promise}     Promise that resolves when the handshake is complete\n   */\n\n\n  var _proto3 = Postmate.prototype;\n\n  _proto3.sendHandshake = function sendHandshake(url) {\n    var _this4 = this;\n\n    var childOrigin = resolveOrigin(url);\n    var attempt = 0;\n    var responseInterval;\n    return new Postmate.Promise(function (resolve, reject) {\n      var reply = function reply(e) {\n        if (!sanitize(e, childOrigin)) return false;\n\n        if (e.data.postmate === 'handshake-reply') {\n          clearInterval(responseInterval);\n\n          if (process.env.NODE_ENV !== 'production') {\n            log('Parent: Received handshake reply from Child');\n          }\n\n          _this4.parent.removeEventListener('message', reply, false);\n\n          _this4.childOrigin = e.origin;\n\n          if (process.env.NODE_ENV !== 'production') {\n            log('Parent: Saving Child origin', _this4.childOrigin);\n          }\n\n          return resolve(new ParentAPI(_this4));\n        } // Might need to remove since parent might be receiving different messages\n        // from different hosts\n\n\n        if (process.env.NODE_ENV !== 'production') {\n          log('Parent: Invalid handshake reply');\n        }\n\n        return reject('Failed handshake');\n      };\n\n      _this4.parent.addEventListener('message', reply, false);\n\n      var doSend = function doSend() {\n        attempt++;\n\n        if (process.env.NODE_ENV !== 'production') {\n          log(\"Parent: Sending handshake attempt \" + attempt, {\n            childOrigin: childOrigin\n          });\n        }\n\n        _this4.child.postMessage({\n          postmate: 'handshake',\n          type: messageType,\n          model: _this4.model\n        }, childOrigin);\n\n        if (attempt === maxHandshakeRequests) {\n          clearInterval(responseInterval);\n        }\n      };\n\n      var loaded = function loaded() {\n        doSend();\n        responseInterval = setInterval(doSend, 500);\n      };\n\n      if (_this4.frame.attachEvent) {\n        _this4.frame.attachEvent('onload', loaded);\n      } else {\n        _this4.frame.onload = loaded;\n      }\n\n      if (process.env.NODE_ENV !== 'production') {\n        log('Parent: Loading frame', {\n          url: url\n        });\n      }\n\n      _this4.frame.src = url;\n    });\n  };\n\n  return Postmate;\n}();\n/**\n * The entry point of the Child\n * @type {Class}\n */\n\n\nPostmate.debug = false;\n\nPostmate.Promise = function () {\n  try {\n    return window ? window.Promise : Promise;\n  } catch (e) {\n    return null;\n  }\n}();\n\nPostmate.Model =\n/*#__PURE__*/\nfunction () {\n  /**\n   * Initializes the child, model, parent, and responds to the Parents handshake\n   * @param {Object} model Hash of values, functions, or promises\n   * @return {Promise}       The Promise that resolves when the handshake has been received\n   */\n  function Model(model) {\n    this.child = window;\n    this.model = model;\n    this.parent = this.child.parent;\n    return this.sendHandshakeReply();\n  }\n  /**\n   * Responds to a handshake initiated by the Parent\n   * @return {Promise} Resolves an object that exposes an API for the Child\n   */\n\n\n  var _proto4 = Model.prototype;\n\n  _proto4.sendHandshakeReply = function sendHandshakeReply() {\n    var _this5 = this;\n\n    return new Postmate.Promise(function (resolve, reject) {\n      var shake = function shake(e) {\n        if (!e.data.postmate) {\n          return;\n        }\n\n        if (e.data.postmate === 'handshake') {\n          if (process.env.NODE_ENV !== 'production') {\n            log('Child: Received handshake from Parent');\n          }\n\n          _this5.child.removeEventListener('message', shake, false);\n\n          if (process.env.NODE_ENV !== 'production') {\n            log('Child: Sending handshake reply to Parent');\n          }\n\n          e.source.postMessage({\n            postmate: 'handshake-reply',\n            type: messageType\n          }, e.origin);\n          _this5.parentOrigin = e.origin; // Extend model with the one provided by the parent\n\n          var defaults = e.data.model;\n\n          if (defaults) {\n            Object.keys(defaults).forEach(function (key) {\n              _this5.model[key] = defaults[key];\n            });\n\n            if (process.env.NODE_ENV !== 'production') {\n              log('Child: Inherited and extended model from Parent');\n            }\n          }\n\n          if (process.env.NODE_ENV !== 'production') {\n            log('Child: Saving Parent origin', _this5.parentOrigin);\n          }\n\n          return resolve(new ChildAPI(_this5));\n        }\n\n        return reject('Handshake Reply Failed');\n      };\n\n      _this5.child.addEventListener('message', shake, false);\n    });\n  };\n\n  return Model;\n}();\n\nexport default Postmate;\n","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import getTarget from \"!../../../node_modules/style-loader/dist/runtime/getTarget.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!./iframe.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = function(css, style){\n      if (style.styleSheet) {\n        style.styleSheet.cssText = css;\n      } else {\n      while (style.firstChild) {\n        style.removeChild(style.firstChild);\n      }\n\n      style.appendChild(document.createTextNode(css));\n    }\n  };\noptions.setAttributes = function(style) {\n        var nonce =\n          typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n\n        if (nonce) {\n          style.setAttribute(\"nonce\", nonce);\n        }\n      };\noptions.insert = function(style){\n    var target = getTarget(\"head\");\n\n    if (!target) {\n      throw new Error(\n        \"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\"\n      );\n    }\n\n    target.appendChild(style);\n  };\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!./iframe.css\";\n       export default content && content.locals ? content.locals : undefined;\n","\"use strict\";\n\nvar memo = {};\n/* istanbul ignore next  */\n\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n\n    memo[target] = styleTarget;\n  }\n\n  return memo[target];\n}\n\nmodule.exports = getTarget;","\"use strict\";\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction addStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var style = document.createElement(\"style\");\n  options.setAttributes(style, options.attributes);\n  options.insert(style);\n  return style;\n}\n\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute(\"media\", media);\n  } else {\n    style.removeAttribute(\"media\");\n  }\n\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  options.styleTagTransform(css, style);\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nfunction domAPI(options) {\n  var style = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(style, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(style);\n    }\n  };\n}\n\nmodule.exports = domAPI;","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.networks = exports.localhost = exports.polygon = exports.xdai = exports.rinkeby = exports.mainnet = void 0;\nconst networks_1 = require(\"./networks\");\n// re-export by name\nvar networks_2 = require(\"./networks\");\nObject.defineProperty(exports, \"mainnet\", { enumerable: true, get: function () { return networks_2.mainnet; } });\nObject.defineProperty(exports, \"rinkeby\", { enumerable: true, get: function () { return networks_2.rinkeby; } });\nObject.defineProperty(exports, \"xdai\", { enumerable: true, get: function () { return networks_2.xdai; } });\nObject.defineProperty(exports, \"polygon\", { enumerable: true, get: function () { return networks_2.polygon; } });\nObject.defineProperty(exports, \"localhost\", { enumerable: true, get: function () { return networks_2.localhost; } });\n// export by chainId\nexports.networks = {\n    1: networks_1.mainnet,\n    4: networks_1.rinkeby,\n    100: networks_1.xdai,\n    137: networks_1.polygon,\n    31337: networks_1.localhost,\n};\nexports.default = exports.networks;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./localhost\"), exports);\n__exportStar(require(\"./mainnet\"), exports);\n__exportStar(require(\"./rinkeby\"), exports);\n__exportStar(require(\"./xdai\"), exports);\n__exportStar(require(\"./polygon\"), exports);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.localhost = void 0;\nexports.localhost = {\n    id: 31117,\n    name: 'localhost',\n    provider: 'http://127.0.0.1:8545',\n    locksmithUri: 'http://127.0.0.1:8080',\n    unlockAppUrl: 'http://0.0.0.0:3000',\n    subgraphURI: 'http://localhost:8000/subgraphs/name/unlock-protocol/unlock',\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mainnet = void 0;\nexports.mainnet = {\n    // httpProvider: null, // we use the injected provider!\n    id: 1,\n    provider: 'https://eth-mainnet.alchemyapi.io/v2/6idtzGwDtRbzil3s6QbYHr2Q_WBfn100',\n    readOnlyProvider: 'https://eth-mainnet.alchemyapi.io/v2/b7Mxclz5hGyHqoeodGLQ17F5Qi97S7xJ',\n    unlockAddress: '0x3d5409CcE1d45233dE1D4eBDEe74b8E004abDD13',\n    name: 'Ethereum',\n    blockTime: 8000,\n    subgraphURI: 'https://api.thegraph.com/subgraphs/name/unlock-protocol/unlock',\n    explorer: {\n        name: 'Etherscan',\n        urls: {\n            address: (address) => `https://etherscan.io/address/${address}`,\n            transaction: (hash) => `https://etherscan.io/tx/${hash}`,\n        },\n    },\n    erc20: {\n        symbol: 'DAI',\n        address: '0x6b175474e89094c44da98b954eedeac495271d0f',\n    },\n    requiredConfirmations: 12,\n    baseCurrencySymbol: 'Eth',\n    locksmithUri: 'https://locksmith.unlock-protocol.com',\n    nativeCurrency: {\n        name: 'Ether',\n        symbol: 'Eth',\n        decimals: 18,\n    },\n};\nexports.default = exports.mainnet;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.polygon = void 0;\nexports.polygon = {\n    provider: 'https://snowy-weathered-waterfall.matic.quiknode.pro/5b11a0413a62a295070c0dfb25637d5f8c591aba/',\n    unlockAddress: '0x14bb3586Ce2946E71B95Fe00Fc73dd30ed830863',\n    id: 137,\n    name: 'Polygon',\n    blockTime: 1000,\n    subgraphURI: 'https://api.thegraph.com/subgraphs/name/unlock-protocol/polygon',\n    explorer: {\n        name: 'Polygonscan',\n        urls: {\n            address: (address) => `https://polygonscan.com/address/${address}`,\n            transaction: (hash) => `https://polygonscan.com/tx/${hash}`,\n        },\n    },\n    requiredConfirmations: 12,\n    erc20: null,\n    baseCurrencySymbol: 'Matic',\n    locksmithUri: 'https://locksmith.unlock-protocol.com',\n    nativeCurrency: {\n        name: 'Matic',\n        symbol: 'MATIC',\n        decimals: 18,\n    },\n};\nexports.default = exports.polygon;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.rinkeby = void 0;\nexports.rinkeby = {\n    provider: 'https://eth-rinkeby.alchemyapi.io/v2/n0NXRSZ9olpkJUPDLBC00Es75jaqysyT',\n    unlockAddress: '0xd8c88be5e8eb88e38e6ff5ce186d764676012b0b',\n    id: 4,\n    name: 'Rinkeby',\n    blockTime: 8000,\n    subgraphURI: 'https://api.thegraph.com/subgraphs/name/unlock-protocol/unlock-rinkeby',\n    explorer: {\n        name: 'Etherscan',\n        urls: {\n            address: (address) => `https://rinkeby.etherscan.io/address/${address}`,\n            transaction: (hash) => `https://rinkeby.etherscan.io/tx/${hash}`,\n        },\n    },\n    requiredConfirmations: 12,\n    erc20: {\n        symbol: 'WEE',\n        address: '0xaFF4481D10270F50f203E0763e2597776068CBc5',\n    },\n    baseCurrencySymbol: 'Eth',\n    locksmithUri: 'https://rinkeby.locksmith.unlock-protocol.com',\n    nativeCurrency: {\n        name: 'Rinkeby Eth',\n        symbol: 'Eth',\n        decimals: 18,\n    },\n};\nexports.default = exports.rinkeby;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.xdai = void 0;\nexports.xdai = {\n    provider: 'https://rpc.xdaichain.com/',\n    unlockAddress: '0x14bb3586Ce2946E71B95Fe00Fc73dd30ed830863',\n    id: 100,\n    name: 'xDai',\n    blockTime: 5000,\n    requiredConfirmations: 12,\n    subgraphURI: 'https://api.thegraph.com/subgraphs/name/unlock-protocol/xdai',\n    explorer: {\n        name: 'Blockscout',\n        urls: {\n            address: (address) => `https://blockscout.com/poa/xdai/address/${address}/transactions`,\n            transaction: (hash) => `https://blockscout.com/poa/xdai/tx/${hash}`,\n        },\n    },\n    erc20: null,\n    locksmithUri: 'https://locksmith.unlock-protocol.com',\n    baseCurrencySymbol: 'xDai',\n    nativeCurrency: {\n        name: 'xDAI',\n        symbol: 'xDai',\n        decimals: 18,\n    },\n};\nexports.default = exports.xdai;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Paywall = exports.CheckoutEvents = exports.checkoutIframeClassName = void 0;\nconst postmate_1 = __importDefault(require(\"postmate\"));\nrequire(\"./iframe.css\");\nconst utils_1 = require(\"./utils\");\nconst localStorage_1 = require(\"./utils/localStorage\");\nconst isUnlocked_1 = require(\"./utils/isUnlocked\");\nconst optimisticUnlocking_1 = require(\"./utils/optimisticUnlocking\");\nconst enableInjectedProvider_1 = require(\"./utils/enableInjectedProvider\");\nexports.checkoutIframeClassName = 'unlock-protocol-checkout';\nvar CheckoutEvents;\n(function (CheckoutEvents) {\n    CheckoutEvents[\"userInfo\"] = \"checkout.userInfo\";\n    CheckoutEvents[\"closeModal\"] = \"checkout.closeModal\";\n    CheckoutEvents[\"transactionInfo\"] = \"checkout.transactionInfo\";\n    CheckoutEvents[\"methodCall\"] = \"checkout.methodCall\";\n    CheckoutEvents[\"onEvent\"] = \"checkout.onEvent\";\n})(CheckoutEvents = exports.CheckoutEvents || (exports.CheckoutEvents = {}));\n/* end type definitions */\nclass Paywall {\n    constructor(paywallConfig, networkConfigs, provider) {\n        this.childCallBuffer = [];\n        this.loadCheckoutModal = (config) => {\n            if (this.iframe) {\n                this.showIframe();\n            }\n            else {\n                this.shakeHands();\n            }\n            this.sendOrBuffer('setConfig', config || this.paywallConfig);\n        };\n        this.getUserAccountAddress = () => {\n            return this.userAccountAddress;\n        };\n        this.resetConfig = (config) => {\n            this.paywallConfig = (0, utils_1.injectProviderInfo)(config, this.provider);\n            this.checkKeysAndLock();\n            this.sendOrBuffer('setConfig', config || this.paywallConfig);\n        };\n        this.getState = () => {\n            return this.lockStatus;\n        };\n        // Saves the user info in the cache\n        this.cacheUserInfo = async (info) => {\n            (0, localStorage_1.store)('userInfo', info);\n        };\n        // Loads the cache\n        this.loadCache = async () => {\n            const info = (0, localStorage_1.retrieve)('userInfo');\n            if (!info) {\n                return this.lockPage();\n            }\n            this.userAccountAddress = info.address;\n            this.checkKeysAndLock();\n        };\n        // Will lock or unlock the page based on the current state\n        this.checkKeysAndLock = async () => {\n            // For each lock.\n            if (!this.userAccountAddress) {\n                return;\n            }\n            this.lockStatus = undefined;\n            const unlockedLocks = await (0, isUnlocked_1.isUnlocked)(this.userAccountAddress, this.paywallConfig, this.networkConfigs);\n            if (unlockedLocks.length) {\n                return this.unlockPage(unlockedLocks);\n            }\n            return this.lockPage();\n        };\n        this.shakeHands = async (config) => {\n            if (!config) {\n                config = this.paywallConfig;\n            }\n            const { unlockAppUrl } = this.networkConfigs[config.network];\n            const child = await new postmate_1.default({\n                url: `${unlockAppUrl}/checkout`,\n                classListArray: [exports.checkoutIframeClassName, 'show'],\n            });\n            this.child = child;\n            this.iframe = document.getElementsByClassName(exports.checkoutIframeClassName)[0];\n            child.on(CheckoutEvents.closeModal, this.hideIframe);\n            child.on(CheckoutEvents.userInfo, this.handleUserInfoEvent);\n            child.on(CheckoutEvents.methodCall, this.handleMethodCallEvent);\n            child.on(CheckoutEvents.onEvent, this.handleOnEventEvent);\n            // transactionInfo event also carries transaction hash.\n            child.on(CheckoutEvents.transactionInfo, this.handleTransactionInfoEvent);\n            // flush the buffer of child calls from before the iframe was ready\n            this.childCallBuffer.forEach((bufferedCall) => child.call(...bufferedCall));\n        };\n        this.sendOrBuffer = (method, args) => {\n            if (this.child) {\n                this.child.call(method, args);\n            }\n            else {\n                this.childCallBuffer.push([method, args]);\n            }\n        };\n        this.handleTransactionInfoEvent = async ({ hash, lock }) => {\n            const { readOnlyProvider } = this.networkConfigs[this.paywallConfig.network];\n            (0, utils_1.dispatchEvent)(utils_1.unlockEvents.transactionSent, { hash, lock });\n            if (!this.paywallConfig.pessimistic) {\n                const optimistic = await (0, optimisticUnlocking_1.willUnlock)(readOnlyProvider, this.userAccountAddress, lock, hash, true // Optimistic if missing\n                );\n                if (optimistic) {\n                    this.unlockPage([lock]);\n                }\n            }\n        };\n        this.handleUserInfoEvent = async (info) => {\n            this.userAccountAddress = info.address;\n            (0, utils_1.dispatchEvent)(utils_1.unlockEvents.authenticated, info);\n            this.cacheUserInfo(info);\n            this.checkKeysAndLock();\n        };\n        this.handleMethodCallEvent = async ({ method, params, id }) => {\n            await (0, enableInjectedProvider_1.enableInjectedProvider)(this.provider);\n            this.provider.sendAsync({ method, params, id }, (error, response) => {\n                this.child.call('resolveMethodCall', { id, error, response });\n            });\n        };\n        this.handleOnEventEvent = async (eventName) => {\n            await (0, enableInjectedProvider_1.enableInjectedProvider)(this.provider);\n            this.provider.on(eventName, () => {\n                this.child.call('resolveOnEvent', eventName);\n            });\n        };\n        this.showIframe = () => {\n            this.iframe.classList.add('show');\n        };\n        this.hideIframe = () => {\n            (0, utils_1.dispatchEvent)(utils_1.unlockEvents.closeModal, {});\n            this.iframe.classList.remove('show');\n        };\n        this.lockPage = () => {\n            this.lockStatus = 'locked';\n            (0, utils_1.dispatchEvent)(utils_1.unlockEvents.status, {\n                state: this.lockStatus,\n            });\n        };\n        this.unlockPage = (locks = []) => {\n            this.lockStatus = 'unlocked';\n            (0, utils_1.dispatchEvent)(utils_1.unlockEvents.status, {\n                locks,\n                state: this.lockStatus,\n            });\n        };\n        this.networkConfigs = networkConfigs;\n        // Use provider in parameter, fall back to injected provider in window (if any)\n        this.provider = provider || (0, enableInjectedProvider_1.getProvider)(window);\n        this.resetConfig(paywallConfig);\n        // Always do this last!\n        this.loadCache();\n    }\n}\nexports.Paywall = Paywall;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.networkConfigs = void 0;\nconst networks_1 = __importDefault(require(\"@unlock-protocol/networks\"));\nlet unlockAppUrl;\nconst baseUrl = PAYWALL_URL || 'localhost'; // Set at build time\nif (baseUrl.match('staging-paywall.unlock-protocol.com')) {\n    unlockAppUrl = 'https://staging-app.unlock-protocol.com';\n}\nelse if (baseUrl.match('paywall.unlock-protocol.com')) {\n    unlockAppUrl = 'https://app.unlock-protocol.com';\n}\nelse {\n    unlockAppUrl = 'http://0.0.0.0:3000';\n}\n// TODO: allow customization of these values when running the script\n// This means probably adding to the unlockProtocolConfig object to include the provider, loksmith Uri and unlockAppUrl\nexports.networkConfigs = {};\nconst chainIds = [1, 4, 100, 137, 31337];\nchainIds.map((chainId) => {\n    const { readOnlyProvider, provider, locksmithUri } = networks_1.default[chainId];\n    exports.networkConfigs[chainId] = {\n        readOnlyProvider: readOnlyProvider || provider,\n        locksmithUri: locksmithUri || '',\n        unlockAppUrl,\n    };\n});\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.enableInjectedProvider = exports.getProvider = void 0;\nconst getProvider = (window) => {\n    // Using a \"modern\" dapp browser\n    if (window.ethereum) {\n        return window.ethereum;\n    }\n    // Using a \"legacy\" dapp browser\n    if (window.web3) {\n        return window.web3.currentProvider;\n    }\n    // Browser is not web3 capable\n    return undefined;\n};\nexports.getProvider = getProvider;\nconst enableInjectedProvider = async (provider) => {\n    // This should not occur; if there is no provider, the paywall\n    // script should prevent the checkout iframe from trying to connect\n    // to one.\n    if (!provider) {\n        throw new Error('Fatal: no web3 provider found.');\n    }\n    // resolves if provider is already enabled or if user allows provider to enable\n    // rejects if user does not allow\n    await provider.enable();\n};\nexports.enableInjectedProvider = enableInjectedProvider;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getTransaction = void 0;\n/**\n * Gets a transaction from the RPC endpoint\n * @param provider\n * @param transactionHash\n */\nconst getTransaction = async (provider, transactionHash) => {\n    const rpcRequest = {\n        method: 'eth_getTransactionByHash',\n        params: [transactionHash],\n        id: 31337,\n        jsonrpc: '2.0',\n    };\n    const response = await fetch(provider, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(rpcRequest),\n    });\n    const body = await response.json();\n    return body.result;\n};\nexports.getTransaction = getTransaction;\nexports.default = exports.getTransaction;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.injectProviderInfo = exports.setupUnlockProtocolVariable = exports.unlockEvents = exports.dispatchEvent = void 0;\n/**\n * Dispatches events\n * @param eventName\n * @param params\n */\nconst dispatchEvent = (eventName, params) => {\n    if (eventName === exports.unlockEvents.status) {\n        // Supporting legacy unlockProtocol event\n        (0, exports.dispatchEvent)('unlockProtocol', params.state);\n    }\n    let event;\n    try {\n        event = new window.CustomEvent(eventName, { detail: params });\n    }\n    catch (e) {\n        // older browsers do events this clunky way.\n        // https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#The_old-fashioned_way\n        // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/initCustomEvent#Parameters\n        event = window.document.createEvent('customevent');\n        event.initCustomEvent(eventName, true /* canBubble */, true /* cancelable */, params);\n    }\n    window.dispatchEvent(event);\n};\nexports.dispatchEvent = dispatchEvent;\n/**\n * Mapping between events and their names\n */\nexports.unlockEvents = {\n    status: 'unlockProtocol.status',\n    authenticated: 'unlockProtocol.authenticated',\n    transactionSent: 'unlockProtocol.transactionSent',\n    closeModal: 'unlockProtocol.closeModal',\n};\nconst setupUnlockProtocolVariable = (properties) => {\n    const unlockProtocol = {};\n    const immutable = {\n        writable: false,\n        configurable: false,\n        enumerable: false,\n    };\n    const immutableProperties = Object.keys(properties).map((name) => {\n        return {\n            [name]: Object.assign({ value: properties[name] }, immutable),\n        };\n    });\n    Object.defineProperties(unlockProtocol, Object.assign({}, ...immutableProperties));\n    const freeze = Object.freeze || Object;\n    // if freeze is available, prevents adding or\n    // removing the object prototype properties\n    // (value, get, set, enumerable, writable, configurable)\n    // TODO: consider whether this is actually necessary\n    freeze(unlockProtocol);\n    try {\n        Object.defineProperties(window, {\n            unlockProtocol: Object.assign({ value: unlockProtocol }, immutable),\n        });\n    }\n    catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn('WARNING: unlockProtocol already defined, cannot re-define it');\n    }\n};\nexports.setupUnlockProtocolVariable = setupUnlockProtocolVariable;\nconst injectProviderInfo = (config, provider) => {\n    const newConfig = Object.assign({}, config);\n    // We want to inform the checkout iframe about the availability of a\n    // delegated provider. However, we will not overwrite an existing\n    // value in the config, in case the paywall owner has reason to\n    // force it one way or the other.\n    if (!newConfig.useDelegatedProvider) {\n        newConfig.useDelegatedProvider = !!provider;\n    }\n    return newConfig;\n};\nexports.injectProviderInfo = injectProviderInfo;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isUnlocked = void 0;\nconst keyExpirationTimestampFor_1 = require(\"./keyExpirationTimestampFor\");\nconst optimisticUnlocking_1 = require(\"./optimisticUnlocking\");\n/**\n * A function which, given a user account, a paywall config will return the list of unlocked locks.\n * It will first check for the existence of keys, and if no valid one has been found\n * it will check for pending transactions which might be optimistic.\n */\nconst isUnlocked = async (userAccountAddress, paywallConfig, networks) => {\n    const unlockedLocks = [];\n    await Promise.all(\n    // For each lock\n    Object.entries(paywallConfig.locks).map(async ([lockAddress]) => {\n        let network = paywallConfig.network;\n        const { readOnlyProvider, locksmithUri } = networks[network];\n        const timestamp = await (0, keyExpirationTimestampFor_1.keyExpirationTimestampFor)(readOnlyProvider, lockAddress, userAccountAddress);\n        if (timestamp > new Date().getTime() / 1000) {\n            // This lock is unlocked!\n            unlockedLocks.push(lockAddress);\n        }\n        else if (!paywallConfig.pessimistic) {\n            const optimistic = await (0, optimisticUnlocking_1.optimisticUnlocking)(readOnlyProvider, locksmithUri, [lockAddress], userAccountAddress);\n            if (optimistic) {\n                unlockedLocks.push(lockAddress);\n            }\n        }\n    }));\n    return unlockedLocks;\n};\nexports.isUnlocked = isUnlocked;\nexports.default = {\n    isUnlocked: exports.isUnlocked,\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.keyExpirationTimestampFor = void 0;\nconst keyExpirationTimestampFor = async (provider, lock, userAddress) => {\n    const rpcRequest = {\n        method: 'eth_call',\n        params: [\n            {\n                to: lock,\n                data: `0xabdf82ce000000000000000000000000${userAddress.substring(2)}`,\n            },\n            'latest',\n        ],\n        id: 31337,\n        jsonrpc: '2.0',\n    };\n    const response = await fetch(provider, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(rpcRequest),\n    });\n    const body = await response.json();\n    const result = body.result;\n    if (parseInt(result, 16) > Number.MAX_SAFE_INTEGER) {\n        // This will cover cases of locks returning NO_SUCH_KEY or `HAS_NEVER_OWNED_KEY` which are strings and much larger than Number.MAX_SAFE_INTEGER\n        return 0;\n    }\n    return parseInt(result, 16) || 0;\n};\nexports.keyExpirationTimestampFor = keyExpirationTimestampFor;\nexports.default = exports.keyExpirationTimestampFor;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.retrieve = exports.store = void 0;\n// copied from the MDN docs as the best way to detect localStorage presence\n// https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API#Testing_for_availability\nfunction localStorageAvailable() {\n    const storage = localStorage;\n    try {\n        const x = '__storage_test__';\n        storage.setItem(x, x);\n        storage.removeItem(x);\n        return true;\n    }\n    catch (e) {\n        return (e instanceof DOMException &&\n            // everything except Firefox\n            (e.code === 22 ||\n                // Firefox\n                e.code === 1014 ||\n                // test name field too, because code might not be present\n                // everything except Firefox\n                e.name === 'QuotaExceededError' ||\n                // Firefox\n                e.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&\n            // acknowledge QuotaExceededError only if there's something already stored\n            storage.length !== 0);\n    }\n}\nexports.default = localStorageAvailable;\nfunction store(key, value) {\n    if (localStorageAvailable()) {\n        window.localStorage.setItem(key, JSON.stringify(value));\n    }\n    else {\n        // Fail silently!\n    }\n}\nexports.store = store;\nfunction retrieve(key) {\n    if (localStorageAvailable()) {\n        const item = localStorage.getItem(key) || '';\n        return JSON.parse(item);\n    }\n    return undefined;\n}\nexports.retrieve = retrieve;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.withinLast24Hours = exports.getTransactionsForUserAndLocks = exports.willUnlock = exports.optimisticLocks = exports.optimisticUnlocking = void 0;\nconst getTransaction_1 = require(\"./getTransaction\");\nconst keyExpirationTimestampFor_1 = require(\"./keyExpirationTimestampFor\");\n/**\n * Yields true if we should be optimistic for user and the locks\n * @param locks\n * @param user\n */\nconst optimisticUnlocking = async (provider, locksmithUri, locks, user) => {\n    const userTransactions = await (0, exports.getTransactionsForUserAndLocks)(locksmithUri, user, locks);\n    const recentTransactions = userTransactions.filter((tx) => (0, exports.withinLast24Hours)(tx.createdAt));\n    const unlocked = await Promise.all(recentTransactions.map((transaction) => {\n        return (0, exports.willUnlock)(provider, user, transaction.recipient, transaction.transactionHash, false // Pessimistic if missing\n        );\n    }));\n    const reducer = (accumulator, currentValue) => currentValue || !!accumulator;\n    return unlocked.reduce(reducer, false);\n};\nexports.optimisticUnlocking = optimisticUnlocking;\n/**\n * Yields an array of optimistically unlocking locks\n * @param locks\n * @param user\n */\nconst optimisticLocks = async (provider, locksmithUri, locks, user) => {\n    const userTransactions = await (0, exports.getTransactionsForUserAndLocks)(locksmithUri, user, locks);\n    const recentTransactions = userTransactions.filter((tx) => (0, exports.withinLast24Hours)(tx.createdAt));\n    const unlocked = [];\n    recentTransactions.map(async (transaction) => {\n        const lockIsOptimistc = await (0, exports.willUnlock)(provider, user, transaction.recipient, transaction.transactionHash, false // Pessimistic if missing\n        );\n        if (lockIsOptimistc) {\n            unlocked.push(transaction.recipient);\n        }\n    });\n    return unlocked;\n};\nexports.optimisticLocks = optimisticLocks;\n/**\n * This method will query the backend to ensure that a transaction will succeed in generating a key for that user.\n * TODO: Everything in here should happen server side.\n * @param user\n * @param lock\n * @param transactionHash\n */\nconst willUnlock = async (provider, user, lock, transactionHash, optimisticIfMissing) => {\n    if (user && lock && transactionHash) {\n        const transaction = await (0, getTransaction_1.getTransaction)(provider, transactionHash);\n        if (!transaction) {\n            return !!optimisticIfMissing;\n        }\n        if (transaction.blockNumber) {\n            // The transaction has actually been mined, so we should check whether indeed there is a key!\n            const expiration = await (0, keyExpirationTimestampFor_1.keyExpirationTimestampFor)(provider, lock, user);\n            return expiration > new Date().getTime() / 1000;\n        }\n        // The transaction, has not been mined, let's be optimisic\n        return true;\n    }\n    return false;\n};\nexports.willUnlock = willUnlock;\n/**\n * Returns all transactions from a user to a lock\n * @param locksmithUri\n * @param user\n * @param locks\n */\nconst getTransactionsForUserAndLocks = async (locksmithUri, user, locks) => {\n    const filterLocks = locks\n        .map((lockAddress) => `recipient[]=${encodeURIComponent(lockAddress)}`)\n        .join('&');\n    const url = `${locksmithUri}/transactions?for=${user}&${filterLocks}`;\n    const response = await fetch(url);\n    const body = await response.json();\n    return body.transactions;\n};\nexports.getTransactionsForUserAndLocks = getTransactionsForUserAndLocks;\nconst withinLast24Hours = (dateString) => {\n    const oneDay = 86400000; // 24 * 60 * 60 * 1000\n    const yesterday = Date.now() - oneDay;\n    const date = new Date(dateString).getTime();\n    return date > yesterday;\n};\nexports.withinLast24Hours = withinLast24Hours;\nexports.default = exports.optimisticUnlocking;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst Paywall_1 = require(\"./Paywall\");\nconst utils_1 = require(\"./utils\");\nconst networkConfigs_1 = require(\"./networkConfigs\");\nconst rawConfig = window.unlockProtocolConfig;\nconst baseUrl = PAYWALL_URL || 'localhost'; // Set at build time\nif (!rawConfig) {\n    console.error('Missing window.unlockProtocolConfig. See docs on how to configure your locks: https://docs.unlock-protocol.com/');\n}\nelse {\n    // set network based on hostname if missing in rawConfig\n    if (!rawConfig.network) {\n        if (baseUrl.match('staging-paywall.unlock-protocol.com')) {\n            rawConfig.network = 4;\n            console.error('Missing network in Unlock config. Assigned default to mainnet: 1. See https://docs.unlock-protocol.com/');\n        }\n        else if (baseUrl.match('paywall.unlock-protocol.com')) {\n            rawConfig.network = 1;\n            console.error('Missing network in Unlock config. Assigned default to rinkeby 4. See https://docs.unlock-protocol.com/');\n        }\n        else {\n            console.error('Missing network in Unlock config. Please set one. See https://docs.unlock-protocol.com/');\n        }\n    }\n    else {\n        rawConfig.network = parseInt(rawConfig.network);\n    }\n    const paywall = new Paywall_1.Paywall(rawConfig, networkConfigs_1.networkConfigs);\n    const { getState, getUserAccountAddress, loadCheckoutModal, resetConfig } = paywall;\n    (0, utils_1.setupUnlockProtocolVariable)({\n        loadCheckoutModal,\n        resetConfig,\n        getUserAccountAddress,\n        getState,\n    });\n}\n"],"sourceRoot":""}