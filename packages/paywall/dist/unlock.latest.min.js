/*! For license information please see unlock.latest.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@unlock-protocol/paywall",[],t):"object"==typeof exports?exports["@unlock-protocol/paywall"]=t():e["@unlock-protocol/paywall"]=t()}(this,(function(){return(()=>{"use strict";var e={160:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(272),r=o.n(n),a=o(609),i=o.n(a)()(r());i.push([e.id,".unlock-protocol-checkout {\n  display: none;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  border: 0;\n  z-index: -2147483647;\n}\n\n.unlock-protocol-checkout.show {\n  display: block;\n  z-index: 2147483647;\n}\n","",{version:3,sources:["webpack://./src/iframe.css"],names:[],mappings:"AAAA;EACE,aAAa;EACb,eAAe;EACf,MAAM;EACN,OAAO;EACP,WAAW;EACX,aAAa;EACb,SAAS;EACT,oBAAoB;AACtB;;AAEA;EACE,cAAc;EACd,mBAAmB;AACrB",sourcesContent:[".unlock-protocol-checkout {\n  display: none;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  border: 0;\n  z-index: -2147483647;\n}\n\n.unlock-protocol-checkout.show {\n  display: block;\n  z-index: 2147483647;\n}\n"],sourceRoot:""}]);const s=i},609:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",n=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),n&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),n&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,n,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);n&&i[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),o&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=o):d[2]=o),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},272:e=>{e.exports=function(e){var t=e[1],o=e[3];if(!o)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),a="/*# ".concat(r," */"),i=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[t].concat(i).concat([a]).join("\n")}return[t].join("\n")}},655:(e,t,o)=>{o.r(t),o.d(t,{default:()=>d});var n="application/x-postmate-v1+json",r=0,a={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},i=function(e,t){return!("string"==typeof t&&e.origin!==t||!e.data||"object"==typeof e.data&&!("postmate"in e.data)||e.data.type!==n||!a[e.data.postmate])},s=function(){function e(e){var t=this;this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.events={},this.listener=function(e){if(!i(e,t.childOrigin))return!1;var o=((e||{}).data||{}).value||{},n=o.data,r=o.name;"emit"===e.data.postmate&&r in t.events&&t.events[r].call(t,n)},this.parent.addEventListener("message",this.listener,!1)}var t=e.prototype;return t.get=function(e){var t=this;return new l.Promise((function(o){var a=++r;t.parent.addEventListener("message",(function e(n){n.data.uid===a&&"reply"===n.data.postmate&&(t.parent.removeEventListener("message",e,!1),o(n.data.value))}),!1),t.child.postMessage({postmate:"request",type:n,property:e,uid:a},t.childOrigin)}))},t.call=function(e,t){this.child.postMessage({postmate:"call",type:n,property:e,data:t},this.childOrigin)},t.on=function(e,t){this.events[e]=t},t.destroy=function(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)},e}(),c=function(){function e(e){var t=this;this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",(function(e){if(i(e,t.parentOrigin)){var o=e.data,r=o.property,a=o.uid,s=o.data;"call"!==e.data.postmate?function(e,t){var o="function"==typeof e[t]?e[t]():e[t];return l.Promise.resolve(o)}(t.model,r).then((function(t){return e.source.postMessage({property:r,postmate:"reply",type:n,uid:a,value:t},e.origin)})):r in t.model&&"function"==typeof t.model[r]&&t.model[r](s)}}))}return e.prototype.emit=function(e,t){this.parent.postMessage({postmate:"emit",type:n,value:{name:e,data:t}},this.parentOrigin)},e}(),l=function(){function e(e){var t=e.container,o=void 0===t?void 0!==o?o:document.body:t,n=e.model,r=e.url,a=e.name,i=e.classListArray,s=void 0===i?[]:i;return this.parent=window,this.frame=document.createElement("iframe"),this.frame.name=a||"",this.frame.classList.add.apply(this.frame.classList,s),o.appendChild(this.frame),this.child=this.frame.contentWindow||this.frame.contentDocument.parentWindow,this.model=n||{},this.sendHandshake(r)}return e.prototype.sendHandshake=function(t){var o,r=this,a=function(e){var t=document.createElement("a");t.href=e;var o=t.protocol.length>4?t.protocol:window.location.protocol,n=t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host;return t.origin||o+"//"+n}(t),c=0;return new e.Promise((function(e,l){r.parent.addEventListener("message",(function t(n){return!!i(n,a)&&("handshake-reply"===n.data.postmate?(clearInterval(o),r.parent.removeEventListener("message",t,!1),r.childOrigin=n.origin,e(new s(r))):l("Failed handshake"))}),!1);var d=function(){c++,r.child.postMessage({postmate:"handshake",type:n,model:r.model},a),5===c&&clearInterval(o)},u=function(){d(),o=setInterval(d,500)};r.frame.attachEvent?r.frame.attachEvent("onload",u):r.frame.onload=u,r.frame.src=t}))},e}();l.debug=!1,l.Promise=function(){try{return window?window.Promise:Promise}catch(e){return null}}(),l.Model=function(){function e(e){return this.child=window,this.model=e,this.parent=this.child.parent,this.sendHandshakeReply()}return e.prototype.sendHandshakeReply=function(){var e=this;return new l.Promise((function(t,o){e.child.addEventListener("message",(function r(a){if(a.data.postmate){if("handshake"===a.data.postmate){e.child.removeEventListener("message",r,!1),a.source.postMessage({postmate:"handshake-reply",type:n},a.origin),e.parentOrigin=a.origin;var i=a.data.model;return i&&Object.keys(i).forEach((function(t){e.model[t]=i[t]})),t(new c(e))}return o("Handshake Reply Failed")}}),!1)}))},e}();const d=l},170:(e,t,o)=>{o.r(t),o.d(t,{default:()=>p});var n=o(62),r=o.n(n),a=o(36),i=o.n(a),s=o(2),c=o.n(s),l=o(173),d=o.n(l),u=o(160),h={styleTagTransform:function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}},setAttributes:function(e){var t=o.nc;t&&e.setAttribute("nonce",t)},insert:function(e){var t=c()("head");if(!t)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");t.appendChild(e)}};h.domAPI=i(),h.insertStyleElement=d(),r()(u.Z,h);const p=u.Z&&u.Z.locals?u.Z.locals:void 0},2:e=>{var t={};e.exports=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}},62:e=>{var t=[];function o(e){for(var o=-1,n=0;n<t.length;n++)if(t[n].identifier===e){o=n;break}return o}function n(e,n){for(var a={},i=[],s=0;s<e.length;s++){var c=e[s],l=n.base?c[0]+n.base:c[0],d=a[l]||0,u="".concat(l," ").concat(d);a[l]=d+1;var h=o(u),p={css:c[1],media:c[2],sourceMap:c[3]};-1!==h?(t[h].references++,t[h].updater(p)):t.push({identifier:u,updater:r(p,n),references:1}),i.push(u)}return i}function r(e,t){var o=t.domAPI(t);return o.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o.update(e=t)}else o.remove()}}e.exports=function(e,r){var a=n(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var s=o(a[i]);t[s].references--}for(var c=n(e,r),l=0;l<a.length;l++){var d=o(a[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}a=c}}},173:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t),t}},36:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var n=o.css,r=o.media,a=o.sourceMap;r?e.setAttribute("media",r):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(n,e)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},408:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.networks=t.localhost=t.polygon=t.xdai=t.rinkeby=t.mainnet=void 0;const n=o(129);var r=o(129);Object.defineProperty(t,"mainnet",{enumerable:!0,get:function(){return r.mainnet}}),Object.defineProperty(t,"rinkeby",{enumerable:!0,get:function(){return r.rinkeby}}),Object.defineProperty(t,"xdai",{enumerable:!0,get:function(){return r.xdai}}),Object.defineProperty(t,"polygon",{enumerable:!0,get:function(){return r.polygon}}),Object.defineProperty(t,"localhost",{enumerable:!0,get:function(){return r.localhost}}),t.networks={1:n.mainnet,4:n.rinkeby,100:n.xdai,137:n.polygon,31337:n.localhost},t.default=t.networks},129:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(o(96),t),r(o(43),t),r(o(854),t),r(o(761),t),r(o(347),t)},96:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.localhost=void 0,t.localhost={id:31117,name:"localhost",provider:"http://127.0.0.1:8545",locksmithUri:"http://127.0.0.1:8080",unlockAppUrl:"http://0.0.0.0:3000",subgraphURI:"http://localhost:8000/subgraphs/name/unlock-protocol/unlock"}},43:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mainnet=void 0,t.mainnet={id:1,provider:"https://eth-mainnet.alchemyapi.io/v2/6idtzGwDtRbzil3s6QbYHr2Q_WBfn100",readOnlyProvider:"https://eth-mainnet.alchemyapi.io/v2/b7Mxclz5hGyHqoeodGLQ17F5Qi97S7xJ",unlockAddress:"0x3d5409CcE1d45233dE1D4eBDEe74b8E004abDD13",name:"Ethereum",blockTime:8e3,subgraphURI:"https://api.thegraph.com/subgraphs/name/unlock-protocol/unlock",explorer:{name:"Etherscan",urls:{address:e=>`https://etherscan.io/address/${e}`,transaction:e=>`https://etherscan.io/tx/${e}`}},erc20:{symbol:"DAI",address:"0x6b175474e89094c44da98b954eedeac495271d0f"},requiredConfirmations:12,baseCurrencySymbol:"Eth",locksmithUri:"https://locksmith.unlock-protocol.com",nativeCurrency:{name:"Ether",symbol:"Eth",decimals:18}},t.default=t.mainnet},347:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.polygon=void 0,t.polygon={provider:"https://snowy-weathered-waterfall.matic.quiknode.pro/5b11a0413a62a295070c0dfb25637d5f8c591aba/",unlockAddress:"0x14bb3586Ce2946E71B95Fe00Fc73dd30ed830863",id:137,name:"Polygon",blockTime:1e3,subgraphURI:"https://api.thegraph.com/subgraphs/name/unlock-protocol/polygon",explorer:{name:"Polygonscan",urls:{address:e=>`https://polygonscan.com/address/${e}`,transaction:e=>`https://polygonscan.com/tx/${e}`}},requiredConfirmations:12,erc20:null,baseCurrencySymbol:"Matic",locksmithUri:"https://locksmith.unlock-protocol.com",nativeCurrency:{name:"Matic",symbol:"MATIC",decimals:18}},t.default=t.polygon},854:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.rinkeby=void 0,t.rinkeby={provider:"https://eth-rinkeby.alchemyapi.io/v2/n0NXRSZ9olpkJUPDLBC00Es75jaqysyT",unlockAddress:"0xd8c88be5e8eb88e38e6ff5ce186d764676012b0b",id:4,name:"Rinkeby",blockTime:8e3,subgraphURI:"https://api.thegraph.com/subgraphs/name/unlock-protocol/unlock-rinkeby",explorer:{name:"Etherscan",urls:{address:e=>`https://rinkeby.etherscan.io/address/${e}`,transaction:e=>`https://rinkeby.etherscan.io/tx/${e}`}},requiredConfirmations:12,erc20:{symbol:"WEE",address:"0xaFF4481D10270F50f203E0763e2597776068CBc5"},baseCurrencySymbol:"Eth",locksmithUri:"https://rinkeby.locksmith.unlock-protocol.com",nativeCurrency:{name:"Rinkeby Eth",symbol:"Eth",decimals:18}},t.default=t.rinkeby},761:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.xdai=void 0,t.xdai={provider:"https://rpc.xdaichain.com/",unlockAddress:"0x14bb3586Ce2946E71B95Fe00Fc73dd30ed830863",id:100,name:"xDai",blockTime:5e3,requiredConfirmations:12,subgraphURI:"https://api.thegraph.com/subgraphs/name/unlock-protocol/xdai",explorer:{name:"Blockscout",urls:{address:e=>`https://blockscout.com/poa/xdai/address/${e}/transactions`,transaction:e=>`https://blockscout.com/poa/xdai/tx/${e}`}},erc20:null,locksmithUri:"https://locksmith.unlock-protocol.com",baseCurrencySymbol:"xDai",nativeCurrency:{name:"xDAI",symbol:"xDai",decimals:18}},t.default=t.xdai},340:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Paywall=t.CheckoutEvents=t.checkoutIframeClassName=void 0;const r=n(o(655));o(170);const a=o(928),i=o(323),s=o(503),c=o(640),l=o(288);var d;t.checkoutIframeClassName="unlock-protocol-checkout",function(e){e.userInfo="checkout.userInfo",e.closeModal="checkout.closeModal",e.transactionInfo="checkout.transactionInfo",e.methodCall="checkout.methodCall",e.onEvent="checkout.onEvent"}(d=t.CheckoutEvents||(t.CheckoutEvents={})),t.Paywall=class{constructor(e,o,n){this.childCallBuffer=[],this.loadCheckoutModal=e=>{this.iframe?this.showIframe():this.shakeHands(),this.sendOrBuffer("setConfig",e||this.paywallConfig)},this.getUserAccountAddress=()=>this.userAccountAddress,this.resetConfig=e=>{this.paywallConfig=(0,a.injectProviderInfo)(e,this.provider),this.checkKeysAndLock(),this.sendOrBuffer("setConfig",e||this.paywallConfig)},this.getState=()=>this.lockStatus,this.cacheUserInfo=async e=>{(0,i.store)("userInfo",e)},this.loadCache=async()=>{const e=(0,i.retrieve)("userInfo");if(!e)return this.lockPage();this.userAccountAddress=e.address,this.checkKeysAndLock()},this.checkKeysAndLock=async()=>{if(!this.userAccountAddress)return;this.lockStatus=void 0;const e=await(0,s.isUnlocked)(this.userAccountAddress,this.paywallConfig,this.networkConfigs);return e.length?this.unlockPage(e):this.lockPage()},this.shakeHands=async e=>{e||(e=this.paywallConfig);const{unlockAppUrl:o}=this.networkConfigs[e.network],n=await new r.default({url:`${o}/checkout`,classListArray:[t.checkoutIframeClassName,"show"]});this.child=n,this.iframe=document.getElementsByClassName(t.checkoutIframeClassName)[0],n.on(d.closeModal,this.hideIframe),n.on(d.userInfo,this.handleUserInfoEvent),n.on(d.methodCall,this.handleMethodCallEvent),n.on(d.onEvent,this.handleOnEventEvent),n.on(d.transactionInfo,this.handleTransactionInfoEvent),this.childCallBuffer.forEach((e=>n.call(...e)))},this.sendOrBuffer=(e,t)=>{this.child?this.child.call(e,t):this.childCallBuffer.push([e,t])},this.handleTransactionInfoEvent=async({hash:e,lock:t})=>{const{readOnlyProvider:o}=this.networkConfigs[this.paywallConfig.network];(0,a.dispatchEvent)(a.unlockEvents.transactionSent,{hash:e,lock:t}),this.paywallConfig.pessimistic||await(0,c.willUnlock)(o,this.userAccountAddress,t,e,!0)&&this.unlockPage([t])},this.handleUserInfoEvent=async e=>{this.userAccountAddress=e.address,(0,a.dispatchEvent)(a.unlockEvents.authenticated,e),this.cacheUserInfo(e),this.checkKeysAndLock()},this.handleMethodCallEvent=async({method:e,params:t,id:o})=>{await(0,l.enableInjectedProvider)(this.provider),this.provider.sendAsync({method:e,params:t,id:o},((e,t)=>{this.child.call("resolveMethodCall",{id:o,error:e,response:t})}))},this.handleOnEventEvent=async e=>{await(0,l.enableInjectedProvider)(this.provider),this.provider.on(e,(()=>{this.child.call("resolveOnEvent",e)}))},this.showIframe=()=>{this.iframe.classList.add("show")},this.hideIframe=()=>{(0,a.dispatchEvent)(a.unlockEvents.closeModal,{}),this.iframe.classList.remove("show")},this.lockPage=()=>{this.lockStatus="locked",(0,a.dispatchEvent)(a.unlockEvents.status,{state:this.lockStatus})},this.unlockPage=(e=[])=>{this.lockStatus="unlocked",(0,a.dispatchEvent)(a.unlockEvents.status,{locks:e,state:this.lockStatus})},this.networkConfigs=o,this.provider=n||(0,l.getProvider)(window),this.resetConfig(e),this.loadCache()}}},657:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.networkConfigs=void 0;const r=n(o(408));let a;const i="localhost";a=i.match("staging-paywall.unlock-protocol.com")?"https://staging-app.unlock-protocol.com":i.match("paywall.unlock-protocol.com")?"https://app.unlock-protocol.com":"http://0.0.0.0:3000",t.networkConfigs={},[1,4,100,137,31337].map((e=>{const{readOnlyProvider:o,provider:n,locksmithUri:i}=r.default[e];t.networkConfigs[e]={readOnlyProvider:o||n,locksmithUri:i||"",unlockAppUrl:a}}))},288:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableInjectedProvider=t.getProvider=void 0,t.getProvider=e=>e.ethereum?e.ethereum:e.web3?e.web3.currentProvider:void 0,t.enableInjectedProvider=async e=>{if(!e)throw new Error("Fatal: no web3 provider found.");await e.enable()}},441:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTransaction=void 0,t.getTransaction=async(e,t)=>{const o={method:"eth_getTransactionByHash",params:[t],id:31337,jsonrpc:"2.0"},n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return(await n.json()).result},t.default=t.getTransaction},928:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.injectProviderInfo=t.setupUnlockProtocolVariable=t.unlockEvents=t.dispatchEvent=void 0,t.dispatchEvent=(e,o)=>{let n;e===t.unlockEvents.status&&(0,t.dispatchEvent)("unlockProtocol",o.state);try{n=new window.CustomEvent(e,{detail:o})}catch(t){n=window.document.createEvent("customevent"),n.initCustomEvent(e,!0,!0,o)}window.dispatchEvent(n)},t.unlockEvents={status:"unlockProtocol.status",authenticated:"unlockProtocol.authenticated",transactionSent:"unlockProtocol.transactionSent",closeModal:"unlockProtocol.closeModal"},t.setupUnlockProtocolVariable=e=>{const t={},o={writable:!1,configurable:!1,enumerable:!1},n=Object.keys(e).map((t=>({[t]:Object.assign({value:e[t]},o)})));Object.defineProperties(t,Object.assign({},...n)),(Object.freeze||Object)(t);try{Object.defineProperties(window,{unlockProtocol:Object.assign({value:t},o)})}catch(e){console.warn("WARNING: unlockProtocol already defined, cannot re-define it")}},t.injectProviderInfo=(e,t)=>{const o=Object.assign({},e);return o.useDelegatedProvider||(o.useDelegatedProvider=!!t),o}},503:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isUnlocked=void 0;const n=o(899),r=o(640);t.isUnlocked=async(e,t,o)=>{const a=[];return await Promise.all(Object.entries(t.locks).map((async([i])=>{let s=t.network;const{readOnlyProvider:c,locksmithUri:l}=o[s];await(0,n.keyExpirationTimestampFor)(c,i,e)>(new Date).getTime()/1e3?a.push(i):t.pessimistic||await(0,r.optimisticUnlocking)(c,l,[i],e)&&a.push(i)}))),a},t.default={isUnlocked:t.isUnlocked}},899:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.keyExpirationTimestampFor=void 0,t.keyExpirationTimestampFor=async(e,t,o)=>{const n={method:"eth_call",params:[{to:t,data:`0xabdf82ce000000000000000000000000${o.substring(2)}`},"latest"],id:31337,jsonrpc:"2.0"},r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),a=(await r.json()).result;return parseInt(a,16)>Number.MAX_SAFE_INTEGER?0:parseInt(a,16)||0},t.default=t.keyExpirationTimestampFor},323:(e,t)=>{function o(){const e=localStorage;try{const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}Object.defineProperty(t,"__esModule",{value:!0}),t.retrieve=t.store=void 0,t.default=o,t.store=function(e,t){o()&&window.localStorage.setItem(e,JSON.stringify(t))},t.retrieve=function(e){if(o()){const t=localStorage.getItem(e)||"";return JSON.parse(t)}}},640:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.withinLast24Hours=t.getTransactionsForUserAndLocks=t.willUnlock=t.optimisticLocks=t.optimisticUnlocking=void 0;const n=o(441),r=o(899);t.optimisticUnlocking=async(e,o,n,r)=>{const a=(await(0,t.getTransactionsForUserAndLocks)(o,r,n)).filter((e=>(0,t.withinLast24Hours)(e.createdAt)));return(await Promise.all(a.map((o=>(0,t.willUnlock)(e,r,o.recipient,o.transactionHash,!1))))).reduce(((e,t)=>t||!!e),!1)},t.optimisticLocks=async(e,o,n,r)=>{const a=(await(0,t.getTransactionsForUserAndLocks)(o,r,n)).filter((e=>(0,t.withinLast24Hours)(e.createdAt))),i=[];return a.map((async o=>{await(0,t.willUnlock)(e,r,o.recipient,o.transactionHash,!1)&&i.push(o.recipient)})),i},t.willUnlock=async(e,t,o,a,i)=>{if(t&&o&&a){const s=await(0,n.getTransaction)(e,a);return s?!s.blockNumber||await(0,r.keyExpirationTimestampFor)(e,o,t)>(new Date).getTime()/1e3:!!i}return!1},t.getTransactionsForUserAndLocks=async(e,t,o)=>{const n=`${e}/transactions?for=${t}&${o.map((e=>`recipient[]=${encodeURIComponent(e)}`)).join("&")}`,r=await fetch(n);return(await r.json()).transactions},t.withinLast24Hours=e=>{const t=Date.now()-864e5;return new Date(e).getTime()>t},t.default=t.optimisticUnlocking}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={id:n,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0});const t=o(340),r=o(928),a=o(657),i=window.unlockProtocolConfig,s="localhost";if(i){i.network?i.network=parseInt(i.network):s.match("staging-paywall.unlock-protocol.com")?(i.network=4,console.error("Missing network in Unlock config. Assigned default to mainnet: 1. See https://docs.unlock-protocol.com/")):s.match("paywall.unlock-protocol.com")?(i.network=1,console.error("Missing network in Unlock config. Assigned default to rinkeby 4. See https://docs.unlock-protocol.com/")):console.error("Missing network in Unlock config. Please set one. See https://docs.unlock-protocol.com/");const e=new t.Paywall(i,a.networkConfigs),{getState:o,getUserAccountAddress:n,loadCheckoutModal:c,resetConfig:l}=e;(0,r.setupUnlockProtocolVariable)({loadCheckoutModal:c,resetConfig:l,getUserAccountAddress:n,getState:o})}else console.error("Missing window.unlockProtocolConfig. See docs on how to configure your locks: https://docs.unlock-protocol.com/")})(),n})()}));
//# sourceMappingURL=unlock.latest.min.js.map